(window["webpackJsonppizza-calendar"]=window["webpackJsonppizza-calendar"]||[]).push([[0],{114:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(15),c=a.n(l),o=(a(87),a(116)),s=a(117),m=a(72),i=a(34),u=a(23),d=a(125),E=a(121),f=a(33),y=a(68),p=a.n(y),g=a(69),h=a.n(g),v=a(3),_=a.n(v),b=a(70),w=a.n(b),k=function(e){var t=e.src,a=e.alt,n=e.width,l=e.height,c=e.fit,o=e.className,s=[],m={width:n||"auto",height:l||"auto",objectFit:c||"contain"};if(Array.isArray(t))for(var i=0;i<t.length;++i)s.push("".concat(t[i]," ").concat(i+1,"x"));else s.push(t);return r.a.createElement("picture",{className:_()(w.a.root,o),style:m},r.a.createElement("img",{srcSet:s.join(" "),alt:a||""}))},x=function(){return r.a.createElement("header",{className:h.a.root},r.a.createElement(d.a,{bg:"dark",variant:"dark",expand:"sm"},r.a.createElement(o.a,{className:"justify-content-between"},r.a.createElement(f.LinkContainer,{to:"/"},r.a.createElement(d.a.Brand,{title:"Can't wait no more"},r.a.createElement(k,{src:p.a,alt:"logo",width:"40px"})," Pizza calendar")),r.a.createElement(d.a.Toggle,{"aria-controls":"header-nav"}),r.a.createElement(d.a.Collapse,{id:"header-nav",className:"flex-grow-0"},r.a.createElement(E.a,null,r.a.createElement(f.LinkContainer,{to:"/",exact:!0},r.a.createElement(E.a.Link,null,"Calendar")),r.a.createElement(f.LinkContainer,{to:"/stats",exact:!0},r.a.createElement(E.a.Link,null,"Stats")),r.a.createElement(f.LinkContainer,{to:"/settings",exact:!0},r.a.createElement(E.a.Link,null,"Settings")))))))},O=a(41),S=a.n(O),N=function(){return r.a.createElement("div",null,"Some icons made by"," ",r.a.createElement("a",{href:"https://www.flaticon.com/authors/freepik",title:"Freepik"},"Freepik")," ","from"," ",r.a.createElement("a",{href:"https://www.flaticon.com/",title:"Flaticon"},"www.flaticon.com"))},j=function(){return r.a.createElement("footer",{className:S.a.root},r.a.createElement("div",{className:S.a.padder}),r.a.createElement(d.a,{bg:"dark",fixed:"bottom",variant:"dark"},r.a.createElement(o.a,null,r.a.createElement(s.a,{className:S.a.row},r.a.createElement(m.a,{lg:"auto",md:"auto",sm:"auto",xs:"auto"},r.a.createElement(d.a.Text,null,"No copyright, for non-commercial use only")),r.a.createElement(m.a,{lg:!0,md:!0,sm:!0,xs:!0}),r.a.createElement(m.a,{lg:"auto",md:"auto",sm:"auto",xs:"auto"},r.a.createElement(d.a.Text,null,r.a.createElement(N,null)))))))},z=a(7),C=a(118),M=a(119),Y=a(10),D=a.n(Y),G=a(73),B=a.n(G),P=a(42),F=a.n(P);var A=({level:e,max:t,width:a,height:n})=>{const l={height:Math.ceil(Math.min(e,t)/t*100)+"%"},c={width:a||"100%",height:n||"100%"};return r.a.createElement("span",{className:F.a.root,style:c},r.a.createElement("span",{className:F.a.empty}),r.a.createElement("span",{className:F.a.full,style:l}))},H=a(122),L=a(123),T=a(76),W=a(77),R=a(74);const K="pizzaCalendar/setStorage",J="pizzaCalendar/clearStorage",I="pizzaCalendar/setDailyScore",V="pizzaCalendar/setSettings";function Z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Z(a,!0).forEach((function(t){Object(R.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Z(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const X={calendar:{},eatenPizzasCount:0,settings:{dailyGoal:6,dailyBonus:0,goal:160}};function U(e,t){switch(t.type){case I:const a=t.payload,n=a.score,r=a.date,l=a.comment;return Q({},e,{calendar:Q({},e.calendar,{[r]:{score:n,comment:l}})});case V:return Q({},e,{settings:t.payload});case K:return t.payload.state;case J:return X;default:return e}}var $="__PIZZA_STORAGE_KEY__";var q=function(){var e=Object(n.useReducer)(U,function(){var e=localStorage.getItem($);try{return e?JSON.parse(e):X}catch(t){return console.error("Can not parse localStorage",e,t),X}}()),t=Object(z.a)(e,1)[0];return Object(n.useEffect)((function(){var e=JSON.stringify(t);localStorage.setItem($,e)}),[t]),e},ee=r.a.createContext([{},function(){return null}]),te=function(e){var t=e.children,a=q();return r.a.createElement(ee.Provider,{value:a},t)},ae=function(){return Object(n.useContext)(ee)};var ne=({onClose:e,onSubmit:t,date:a,show:n})=>{const l=ae(),c=Object(z.a)(l,1)[0],o=c.settings,s=c.calendar,m=o.dailyGoal,i=o.dailyBonus,u=s[a]||{},d=u.score,E=void 0===d?0:d,f=u.comment,y=void 0===f?"":f;return r.a.createElement(H.a,{size:"sm",centered:!0,show:n,onHide:e},r.a.createElement(H.a.Header,{closeButton:!0},r.a.createElement(H.a.Title,null,"Set your score!")),r.a.createElement(H.a.Body,null,r.a.createElement(L.a,{id:"dailyScoreSet",onSubmit:t},r.a.createElement(T.a,{value:a,hidden:!0,readOnly:!0,name:"date"}),r.a.createElement(L.a.Group,null,r.a.createElement(W.a,null,"Score"),r.a.createElement(T.a,{name:"score",as:"select",placeholder:"Remember: nobody likes cheaters","aria-label":"Remember: nobody likes cheaters","aria-describedby":"daily-score",defaultValue:String(E||0)},new Array(m+i+1).fill(null).map((e,t)=>r.a.createElement("option",{key:t},t)))),r.a.createElement(L.a.Group,null,r.a.createElement(W.a,null,"Comment"),r.a.createElement(L.a.Control,{as:"textarea",rows:"3",name:"comment",defaultValue:y})))),r.a.createElement(H.a.Footer,null,r.a.createElement(C.a,{variant:"primary",type:"submit",form:"dailyScoreSet"},"Save Changes")))},re=a(31),le=a.n(re),ce=B.a.bind(le.a),oe=["\u041f\u043d","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041f\u0442","\u0421\u0431","\u0412\u0441"],se=function(e,t,a){return e.isSame(t,a)||e.isBefore(t,a)},me=function(e){for(var t=e.date,a=e.onDayClick,n=t.startOf("month"),l=t.endOf("month"),c=n.startOf("week"),o=l.endOf("week"),s=ae(),m=Object(z.a)(s,1)[0],i=[],u=c.clone();se(u,o,"day");){var d=u.week(),E=u.endOf("week"),f=[],y=function(){var e=u.format("DD"),t=u.format("YYYY-MM-DD"),c=u.isBefore(n,"day")||u.isAfter(l,"day"),o=ce({date:!0,outOfMonth:c}),s=m.calendar[t]?m.calendar[t].score:0,i=m.settings.dailyGoal;f.push(r.a.createElement("td",{className:o,key:e,onClick:function(){return a(t)}},r.a.createElement("div",{className:le.a.dailyPizzaMeter},r.a.createElement(A,{level:s,max:i})),e)),u=u.add(1,"day")};do{y()}while(se(u,E,"day"));i.push(r.a.createElement("tr",{key:d},r.a.createElement("td",{className:le.a.weekOfYear},d),f))}return r.a.createElement(r.a.Fragment,null,i.map((function(e){return e})))},ie=function(){var e=Object(n.useState)(D()()),t=Object(z.a)(e,2),a=t[0],l=t[1],c=ae(),o=Object(z.a)(c,2)[1],s=Object(n.useState)(!1),m=Object(z.a)(s,2),i=m[0],u=m[1],d=Object(n.useState)(null),E=Object(z.a)(d,2),f=E[0],y=E[1],p=function(){return u(!1)};return r.a.createElement("div",{className:le.a.root},r.a.createElement("div",{className:le.a.header},r.a.createElement(C.a,{variant:"light",onClick:function(){return l(a.set("month",a.month()-1))}},"\u25c4"),r.a.createElement("h3",null,a.year()===D()().year()?a.format("MMMM"):a.format("MMMM YYYY")),r.a.createElement(C.a,{variant:"light",onClick:function(){return l(a.set("month",a.month()+1))}},"\u25ba")),r.a.createElement(M.a,{bordered:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("td",null,"#"),oe.map((function(e){return r.a.createElement("td",{key:e},e)})))),r.a.createElement("tbody",null,r.a.createElement(me,{onDayClick:function(e){u(!0),y(e)},date:a}))),r.a.createElement(ne,{date:f,show:i,onClose:p,onSubmit:function(e){var t=new FormData(e.currentTarget),a=t.get("date"),n=Number(t.get("score")),r=String(t.get("comment"))||void 0;o((({score:e,date:t,comment:a})=>({type:I,payload:{score:e,date:t,comment:a}}))({date:a,score:n,comment:r})),p(),e.preventDefault(),e.stopPropagation()}}))},ue=a(120),de=a(25),Ee=a.n(de),fe=function(e){var t=e.percentage;return t<0?r.a.createElement("div",{className:Ee.a.alert},r.a.createElement(ue.a,{variant:"danger"},"You owe pizza bank!")):t>=100?r.a.createElement("div",{className:Ee.a.alert},r.a.createElement(ue.a,{variant:"success"},"Hoooray! You deserve pizza!")):null},ye=function(){var e=ae(),t=Object(z.a)(e,1)[0],a=function(e){var t=e.calendar,a=e.eatenPizzasCount,n=e.settings;return Object.values(t).reduce((function(e,t){return e+(t.score||0)}),0)-n.goal*a}(t),n=t.settings.goal,l=Math.ceil(a/n*100),c=a<0?0:a>=n?100:l,o={width:"".concat(c,"%")},s={textShadow:"rgba(".concat(255*(1-c/100),", ").concat(c/100*255,", 0) 0 0 4px")};return r.a.createElement("div",{className:Ee.a.root},r.a.createElement("div",{className:Ee.a.progress},r.a.createElement("div",{className:Ee.a.empty}),r.a.createElement("div",{className:Ee.a.full,style:o})),r.a.createElement("div",{className:Ee.a.percentage,style:s},"".concat(l," %")),r.a.createElement(fe,{percentage:l}))},pe=a(124),ge=a(126),he=a(53),ve=a.n(he);var _e=()=>{const e=ae(),t=Object(z.a)(e,2),a=t[0],n=t[1],l=a.settings;return r.a.createElement(o.a,{className:"flex-grow-1"},r.a.createElement(pe.a,{defaultActiveKey:"0"},r.a.createElement(ge.a,null,r.a.createElement(pe.a.Toggle,{as:ge.a.Header,eventKey:"0",className:ve.a.cardHeader},"Preferences"),r.a.createElement(pe.a.Collapse,{eventKey:"0"},r.a.createElement(ge.a.Body,null,r.a.createElement(L.a,{onSubmit:e=>{const t=new FormData(e.currentTarget),a=Number(t.get("goal")),r=Number(t.get("dailyGoal")),l=Number(t.get("dailyBonus"));!a||!r||!l||a<=0||r<=0||l<0?alert("Bad preferences"):n((({dailyGoal:e,dailyBonus:t,goal:a})=>({type:V,payload:{dailyGoal:e,dailyBonus:t,goal:a}}))({goal:a,dailyGoal:r,dailyBonus:l})),console.log(Array.from(t.entries())),e.preventDefault(),e.stopPropagation()}},r.a.createElement(L.a.Group,null,r.a.createElement(L.a.Label,null,"Daily goal"),r.a.createElement(L.a.Control,{as:"input",name:"dailyGoal",type:"number",defaultValue:l.dailyGoal})),r.a.createElement(L.a.Group,null,r.a.createElement(L.a.Label,null,"Daily bonus points"),r.a.createElement(L.a.Control,{as:"input",name:"dailyBonus",type:"number",defaultValue:l.dailyBonus})),r.a.createElement(L.a.Group,null,r.a.createElement(L.a.Label,null,"Pizza Goal"),r.a.createElement(L.a.Control,{as:"input",name:"goal",type:"number",defaultValue:l.goal})),r.a.createElement(C.a,{type:"submit",variant:"primary"},"Save Preferences"))))),r.a.createElement(ge.a,null,r.a.createElement(pe.a.Toggle,{as:ge.a.Header,eventKey:"1",className:ve.a.cardHeader},"Store"),r.a.createElement(pe.a.Collapse,{eventKey:"1"},r.a.createElement(ge.a.Body,null,r.a.createElement("pre",null,JSON.stringify(a,null,2)),r.a.createElement(C.a,{onClick:()=>n({type:J}),variant:"danger"},"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0432\u0441\u0451!"))))))},be=a(44),we=a.n(be),ke=function(e,t){for(var a=[],n=e,r=t;r>=0;--r)a.push(n.format("YYYY-MM-DD")),n=n.subtract(1,"day");return a.sort()},xe=function(e,t){return t.map((function(t){return e[t]&&e[t].score||0}))},Oe=function(e){var t=e.id||Math.random().toString(16).slice(2);return r.a.createElement("defs",null,r.a.createElement("marker",{id:"triangle_".concat(t),viewBox:"0 0 10 10",refX:"1",refY:"5",markerUnits:"strokeWidth",markerWidth:"10",markerHeight:"10",orient:"auto"},r.a.createElement("path",{d:"M 0 0 L 10 5 L 0 10 z",fill:"#000"})))},Se=function(e){var t=e.data,a=e.yStep,n=290/t.length,l=t.map((function(e,t){return{x:5+t*n,y:90-a*e}})),c="M "+l.map((function(e){var t=e.x,a=e.y;return"".concat(t," ").concat(a)})).join(" L ");return r.a.createElement(r.a.Fragment,null,r.a.createElement("path",{d:c,stroke:"#0f0",strokeWidth:.25,fill:"none"}),l.map((function(e){var t=e.x,a=e.y;return r.a.createElement("circle",{cx:t,cy:a,r:.5,fill:"#00f",key:"point_".concat(t,"_").concat(a)})})))},Ne=function(e){var t=e.data,a=e.every,n=void 0===a?3:a,l=290/t.length;return r.a.createElement(r.a.Fragment,null,t.map((function(e,t){return t%n?null:r.a.createElement(r.a.Fragment,{key:"serif_x_".concat(t)},r.a.createElement("path",{d:"M ".concat(5+t*l," ").concat(89.5," v1"),stroke:"#000",strokeWidth:.05}),r.a.createElement("g",{transform:"translate(-.5, 2)"},r.a.createElement("text",{x:"".concat(5+t*l),y:89.5,className:we.a.serifText,transform:"rotate(45, ".concat(5+t*l,", ").concat(89.5,")"),textLength:e.length-2},e)))})))},je=function(){var e=ae(),t=Object(z.a)(e,1)[0],a=t.calendar,l=t.settings.dailyGoal,c=D()(),o=Object(n.useState)(c),s=Object(z.a)(o,2),m=s[0],i=(s[1],Object(n.useState)(30)),u=Object(z.a)(i,2),d=u[0],E=(u[1],Object.keys(a),ke(m,d)),f=xe(a,E),y=Math.abs(-80/l);return r.a.createElement("div",{className:we.a.root},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(300," 100"),preserveAspectRatio:"none",className:we.a.svg},r.a.createElement(Oe,{id:"_"}),r.a.createElement("rect",{width:"100%",height:"100%",x:"0",y:"0",fill:"none",strokeWidth:.05,stroke:"#0f0"}),r.a.createElement("path",{d:"M 0 ".concat(90," H ").concat(295," "),stroke:"#000",strokeWidth:.05,markerEnd:"url(#triangle__)"}),r.a.createElement("path",{d:"M ".concat(5," 100 V ").concat(5," "),stroke:"#000",strokeWidth:.05,markerEnd:"url(#triangle__)"}),r.a.createElement(Se,{data:f,yStep:y}),r.a.createElement(Ne,{data:E})))},ze=function(e){return function(t,a){for(var n=Object.keys(t).sort()[0],r=D()(),l=D()(n,"YYYY-MM-DD"),c=0,o="none",s=0;l.isBefore(r,"day")||l.isSame(r,"day");){var m=l.format("YYYY-MM-DD"),i=t[m],u=Number(i&&i.score)||0;e(u,a)&&++s>c&&(c=s,o=m),u||(s=0),l=l.add(1,"day")}return{value:c,date:o}}},Ce=function(e){return function(t,a){var n=Object.keys(t).sort(),r=n[n.length-1],l=n[0],c=D()(r,"YYYY-MM-DD"),o="newer",s=0;if(!r)return{value:0,date:o};for(;c.isAfter(l,"day")||c.isSame(l,"day");){var m=c.format("YYYY-MM-DD"),i=t[m],u=Number(i&&i.score)||0;if(e(u,a)&&(s++,o=m),!u)break;c=c.subtract(1,"day")}return{value:s,date:o}}},Me=function(){var e=ae(),t=Object(z.a)(e,1)[0],a=t.calendar,n=t.settings,l=ze((function(e){return e>0}))(a,n.dailyGoal),c=ze((function(e,t){return e>0&&e===t}))(a,n.dailyGoal),o=Ce((function(e){return e>0}))(a,n.dailyGoal),s=Ce((function(e,t){return e>0&&e===t}))(a,n.dailyGoal);return r.a.createElement(M.a,{bordered:!0,striped:!0,hover:!0,size:"sm"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Longest High Series"),r.a.createElement("td",null,c.value),r.a.createElement("td",null,"finished at:"),r.a.createElement("td",null,c.date)),r.a.createElement("tr",null,r.a.createElement("td",null,"Longest Series:"),r.a.createElement("td",null,l.value),r.a.createElement("td",null,"finished at:"),r.a.createElement("td",null,l.date)),r.a.createElement("tr",null,r.a.createElement("td",null,"Current High Series:"),r.a.createElement("td",null,s.value),r.a.createElement("td",null,"started at:"),r.a.createElement("td",null,s.date)),r.a.createElement("tr",null,r.a.createElement("td",null,"Current Series:"),r.a.createElement("td",null,o.value),r.a.createElement("td",null,"started at:"),r.a.createElement("td",null,o.date))))},Ye=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(je,null),r.a.createElement(Me,null))},De=a(78),Ge=a.n(De);let Be="/";Be="/pizza-calendar/";const Pe=()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,{className:"justify-content-center"},r.a.createElement(m.a,{lg:"auto",md:"auto",sm:"auto",xs:"auto"},r.a.createElement(ye,null))),r.a.createElement(s.a,{className:"justify-content-md-center"},r.a.createElement(m.a,null,r.a.createElement(ie,null)))),Fe=()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,{className:"justify-content-center"},r.a.createElement(m.a,null,r.a.createElement(_e,null)))),Ae=()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,{className:"justify-content-center"},r.a.createElement(m.a,null,r.a.createElement(Ye,null))));var He=()=>r.a.createElement(i.BrowserRouter,{basename:Be},r.a.createElement("div",{className:"App"},r.a.createElement(te,null,r.a.createElement(x,null),r.a.createElement(o.a,{className:Ge.a.content},r.a.createElement(u.g,null,r.a.createElement(u.d,{path:"/",component:Pe,exact:!0}),r.a.createElement(u.d,{path:"/stats",component:Ae,exact:!0}),r.a.createElement(u.d,{path:"/settings",component:Fe,exact:!0}))),r.a.createElement(j,null))));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(112),a(113);var Le=a(79),Te=a.n(Le),We=a(80),Re=a.n(We),Ke=a(81),Je=a.n(Ke);D.a.locale("ru"),D.a.extend(Te.a),D.a.extend(Re.a),D.a.extend(Je.a),c.a.render(r.a.createElement(He,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},25:function(e,t,a){e.exports={root:"styles_root__2yGfR",progress:"styles_progress__3nT8N",empty:"styles_empty__3Jv49",full:"styles_full__3NRnI",percentage:"styles_percentage__F-DJG",alert:"styles_alert__2S3Kt"}},31:function(e,t,a){e.exports={root:"styles_root__2ZEkx",header:"styles_header__M9knd",date:"styles_date__wwbG8",dailyPizzaMeter:"styles_dailyPizzaMeter__3DtwB",outOfMonth:"styles_outOfMonth__3xhaQ"}},41:function(e,t,a){e.exports={row:"styles_row__2xCRJ",padder:"styles_padder__3E2eA"}},42:function(e,t,a){e.exports={root:"styles_root__1yk8g",empty:"styles_empty__1z1lv",full:"styles_full__2gSHK"}},44:function(e,t,a){e.exports={svg:"styles_svg__3Z78Q",serifText:"styles_serifText__1AWIk",root:"styles_root__2T_Hk"}},53:function(e,t,a){e.exports={cardHeader:"styles_cardHeader__1FpO-"}},68:function(e,t,a){e.exports=a.p+"static/media/pizza_heart.c4a46534.svg"},69:function(e,t,a){e.exports={root:"styles_root__2e9Hh",row:"styles_row__uIRiK"}},70:function(e,t,a){e.exports={root:"styles_root__3jXdS"}},78:function(e,t,a){e.exports={App:"styles_App__ASPDC",justifyCenter:"styles_justifyCenter__cD8Wi",content:"styles_content__1Ykho"}},82:function(e,t,a){e.exports=a(114)},87:function(e,t,a){}},[[82,1,2]]]);
//# sourceMappingURL=main.162128be.chunk.js.map